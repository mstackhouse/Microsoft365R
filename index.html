<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interface to the Microsoft 365 Suite of Cloud Services • Microsoft365R</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Interface to the Microsoft 365 Suite of Cloud Services">
<meta property="og:description" content="An interface to the Microsoft 365 (formerly known as Office 365) suite of cloud services, building on the framework supplied by the AzureGraph package. Enables access from R to data stored in Teams, SharePoint Online and OneDrive, including the ability to list drive folder contents, upload and download files, send messages, and retrieve data lists. Also provides a full-featured Outlook email client, with the ability to send emails and manage emails and mail folders.">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">Microsoft365R</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/auth.html">Authenticating to Microsoft 365</a>
    </li>
    <li>
      <a href="articles/od_sp.html">OneDrive and SharePoint</a>
    </li>
    <li>
      <a href="articles/outlook.html">Managing emails with Outlook</a>
    </li>
    <li>
      <a href="articles/scripted.html">Using Microsoft365R in an unattended script</a>
    </li>
    <li>
      <a href="articles/shiny.html">Using Microsoft365R in a Shiny app</a>
    </li>
    <li>
      <a href="articles/teams.html">Teams</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Azure/Microsoft365R/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="microsoft365r-">Microsoft365R <img src="reference/figures/logo.png" align="right" width="150"><a class="anchor" aria-label="anchor" href="#microsoft365r-"></a>
</h1></div>

<p>Microsoft365R is intended to be a simple yet powerful R interface to <a href="https://www.microsoft.com/en-us/microsoft-365" class="external-link">Microsoft 365</a> (formerly known as Office 365), leveraging the facilities provided by the <a href="https://cran.r-project.org/package=AzureGraph" class="external-link">AzureGraph</a> package. Currently it supports Microsoft Teams, Outlook, SharePoint Online, and OneDrive.</p>
<p>The primary repo for this package is at <a href="https://github.com/Azure/Microsoft365R" class="external-link uri">https://github.com/Azure/Microsoft365R</a>; please submit issues and PRs there. It is also mirrored at the Cloudyr org at <a href="https://github.com/cloudyr/Microsoft365R" class="external-link uri">https://github.com/cloudyr/Microsoft365R</a>. You can install the development version of the package with <code>devtools::install_github("Azure/Microsoft365R")</code>.</p>
<div class="section level2">
<h2 id="authentication">Authentication<a class="anchor" aria-label="anchor" href="#authentication"></a>
</h2>
<p>The first time you call one of the Microsoft365R functions (see below), it will use your Internet browser to authenticate with Azure Active Directory, in a similar manner to other web apps. See <a href="https://github.com/Azure/Microsoft365R/blob/master/inst/app_registration.md" class="external-link">app_registration.md</a> for more details on the app registration and permissions requested. The “Authentication” vignette describes the authentication process in greater depth, including optional arguments and troubleshooting common problems.</p>
</div>
<div class="section level2">
<h2 id="client-functions">Client functions<a class="anchor" aria-label="anchor" href="#client-functions"></a>
</h2>
<p>Microsoft365R defines a number of top-level client functions to access the individual Microsoft 365 services. Below are some simple code examples that show how to use the package. For more information, see the vignettes for the individual services.</p>
<div class="section level3">
<h3 id="onedrive">OneDrive<a class="anchor" aria-label="anchor" href="#onedrive"></a>
</h3>
<p>To access your personal OneDrive call <code><a href="reference/client.html">get_personal_onedrive()</a></code>, and to access OneDrive for Business, call <code><a href="reference/client.html">get_business_onedrive()</a></code>. These return an R6 client object of class <code>ms_drive</code>, which has methods for working with files and folders. `</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">od</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/client.html">get_personal_onedrive</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">odb</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/client.html">get_business_onedrive</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># list files and folders</span>
<span class="va">od</span><span class="op">$</span><span class="fu">list_items</span><span class="op">(</span><span class="op">)</span>
<span class="va">od</span><span class="op">$</span><span class="fu">list_items</span><span class="op">(</span><span class="st">"Documents"</span><span class="op">)</span>

<span class="co"># upload and download files</span>
<span class="va">od</span><span class="op">$</span><span class="fu">upload_file</span><span class="op">(</span><span class="st">"somedata.xlsx"</span><span class="op">)</span>
<span class="va">od</span><span class="op">$</span><span class="fu">download_file</span><span class="op">(</span><span class="st">"Documents/myfile.docx"</span><span class="op">)</span>

<span class="co"># create a folder</span>
<span class="va">od</span><span class="op">$</span><span class="fu">create_folder</span><span class="op">(</span><span class="st">"Documents/newfolder"</span><span class="op">)</span>

<span class="co"># open a document for editing in Word Online</span>
<span class="va">od</span><span class="op">$</span><span class="fu">open_item</span><span class="op">(</span><span class="st">"Documents/myfile.docx"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="sharepoint-online">SharePoint Online<a class="anchor" aria-label="anchor" href="#sharepoint-online"></a>
</h3>
<p>To access a SharePoint site, use the <code><a href="reference/client.html">get_sharepoint_site()</a></code> function and provide the site name, URL or ID. You can also list the sites you’re following with <code><a href="reference/client.html">list_sharepoint_sites()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/client.html">list_sharepoint_sites</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">site</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/client.html">get_sharepoint_site</a></span><span class="op">(</span><span class="st">"My site"</span><span class="op">)</span>

<span class="co"># document libraries</span>
<span class="va">site</span><span class="op">$</span><span class="fu">list_drives</span><span class="op">(</span><span class="op">)</span>

<span class="co"># default document library</span>
<span class="va">drv</span> <span class="op">&lt;-</span> <span class="va">site</span><span class="op">$</span><span class="fu">get_drive</span><span class="op">(</span><span class="op">)</span>

<span class="co"># a drive has the same methods as for OneDrive above</span>
<span class="va">drv</span><span class="op">$</span><span class="fu">list_items</span><span class="op">(</span><span class="op">)</span>
<span class="va">drv</span><span class="op">$</span><span class="fu">open_item</span><span class="op">(</span><span class="st">"teamproject/plan.xlsx"</span><span class="op">)</span>

<span class="co"># lists</span>
<span class="va">site</span><span class="op">$</span><span class="fu">get_lists</span><span class="op">(</span><span class="op">)</span>

<span class="va">lst</span> <span class="op">&lt;-</span> <span class="va">site</span><span class="op">$</span><span class="fu">get_list</span><span class="op">(</span><span class="st">"my-list"</span><span class="op">)</span>

<span class="co"># return the items in the list as a data frame</span>
<span class="va">lst</span><span class="op">$</span><span class="fu">list_items</span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="teams">Teams<a class="anchor" aria-label="anchor" href="#teams"></a>
</h3>
<p>To access a team in Microsoft Teams, use the <code><a href="reference/client.html">get_team()</a></code> function and provide the team name or ID. You can also list the teams you’re in with <code><a href="reference/client.html">list_teams()</a></code>. These return objects of R6 class <code>ms_team</code> which has methods for working with channels; in turn, a channel has methods for working with messages and transferring files.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/client.html">list_teams</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">team</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/client.html">get_team</a></span><span class="op">(</span><span class="st">"My team"</span><span class="op">)</span>

<span class="co"># associated SharePoint site and drive</span>
<span class="va">team</span><span class="op">$</span><span class="fu">get_drive</span><span class="op">(</span><span class="op">)</span>
<span class="va">team</span><span class="op">$</span><span class="fu">get_sharepoint_site</span><span class="op">(</span><span class="op">)</span>

<span class="co"># channels</span>
<span class="va">team</span><span class="op">$</span><span class="fu">list_channels</span><span class="op">(</span><span class="op">)</span>

<span class="va">chan</span> <span class="op">&lt;-</span> <span class="va">team</span><span class="op">$</span><span class="fu">get_channel</span><span class="op">(</span><span class="st">"General"</span><span class="op">)</span>

<span class="co"># messages</span>
<span class="va">chan</span><span class="op">$</span><span class="fu">list_messages</span><span class="op">(</span><span class="op">)</span>
<span class="va">chan</span><span class="op">$</span><span class="fu">send_message</span><span class="op">(</span><span class="st">"Hello from R"</span>, attachments<span class="op">=</span><span class="st">"hello.md"</span><span class="op">)</span>

<span class="va">msg</span> <span class="op">&lt;-</span> <span class="va">chan</span><span class="op">$</span><span class="fu">get_message</span><span class="op">(</span><span class="st">"msg-id"</span><span class="op">)</span>
<span class="va">msg</span><span class="op">$</span><span class="fu">send_reply</span><span class="op">(</span><span class="st">"Reply from R"</span><span class="op">)</span>

<span class="co"># files: similar methods to OneDrive</span>
<span class="va">chan</span><span class="op">$</span><span class="fu">list_files</span><span class="op">(</span><span class="op">)</span>
<span class="va">chan</span><span class="op">$</span><span class="fu">download_file</span><span class="op">(</span><span class="st">"myfile.docx"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="outlook">Outlook<a class="anchor" aria-label="anchor" href="#outlook"></a>
</h3>
<p>Microsoft365R supports sending, receiving and managing emails in Outlook. Use the <code><a href="reference/client.html">get_personal_outlook()</a></code> method to access your emails for your personal account, and <code><a href="reference/client.html">get_business_outlook()</a></code> for your work or school account. Emails can optionally be composed using either the blastula or emayili packages.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">outl</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/client.html">get_personal_outlook</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">outlb</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/client.html">get_business_outlook</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># compose an email with blastula</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rich-iannone/blastula" class="external-link">blastula</a></span><span class="op">)</span>
<span class="va">bl_body</span> <span class="op">&lt;-</span> <span class="st">"## Hello!

This is an email message that was generated by the blastula package.

We can use **Markdown** formatting with the `md()` function.

Cheers,

The blastula team"</span>

<span class="va">bl_em</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/blastula/man/compose_email.html" class="external-link">compose_email</a></span><span class="op">(</span>
    body<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/blastula/man/md.html" class="external-link">md</a></span><span class="op">(</span><span class="va">bl_body</span><span class="op">)</span>,
    footer<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/blastula/man/md.html" class="external-link">md</a></span><span class="op">(</span><span class="st">"sent via Microsoft365R"</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">em</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span><span class="fu">create_email</span><span class="op">(</span><span class="va">bl_em</span>, subject<span class="op">=</span><span class="st">"Hello from R"</span>, to<span class="op">=</span><span class="st">"bob@example.com"</span><span class="op">)</span>

<span class="co"># add an attachment and send it</span>
<span class="va">em</span><span class="op">$</span><span class="fu">add_attachment</span><span class="op">(</span><span class="st">"mydocument.docx"</span><span class="op">)</span>
<span class="va">em</span><span class="op">$</span><span class="fu">send</span><span class="op">(</span><span class="op">)</span>

<span class="co"># list the most recent emails in your inbox</span>
<span class="va">emlst</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span><span class="fu">list_emails</span><span class="op">(</span><span class="op">)</span>

<span class="co"># reply to the most recent email</span>
<span class="va">emlst</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span>
    <span class="fu">create_reply</span><span class="op">(</span><span class="st">"Replying from R"</span><span class="op">)</span><span class="op">$</span>
    <span class="fu">send</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<hr>
<p align="center">
<a href="https://github.com/Azure/AzureR" class="external-link"><img src="https://github.com/Azure/AzureR/raw/master/images/logo2.png" width="800"></a>
</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=Microsoft365R" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/Azure/Microsoft365R/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/Azure/Microsoft365R/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing Microsoft365R</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Hong Ooi <br><small class="roles"> Author, maintainer </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=Microsoft365R" class="external-link"><img src="https://www.r-pkg.org/badges/version/Microsoft365R" alt="CRAN"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Hong Ooi.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
