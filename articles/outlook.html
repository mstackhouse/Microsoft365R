<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Managing emails with Outlook • Microsoft365R</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Managing emails with Outlook">
<meta property="og:description" content="Microsoft365R">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Microsoft365R</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.4.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/auth.html">Authenticating to Microsoft 365</a>
    </li>
    <li>
      <a href="../articles/od_sp.html">OneDrive and SharePoint</a>
    </li>
    <li>
      <a href="../articles/outlook.html">Managing emails with Outlook</a>
    </li>
    <li>
      <a href="../articles/scripted.html">Using Microsoft365R in an unattended script</a>
    </li>
    <li>
      <a href="../articles/shiny.html">Using Microsoft365R in a Shiny app</a>
    </li>
    <li>
      <a href="../articles/teams.html">Teams</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Azure/Microsoft365R/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Managing emails with Outlook</h1>
                        <h4 data-toc-skip class="author">Hong Ooi</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Azure/Microsoft365R/blob/HEAD/vignettes/outlook.Rmd" class="external-link"><code>vignettes/outlook.Rmd</code></a></small>
      <div class="hidden name"><code>outlook.Rmd</code></div>

    </div>

    
    
<p>This vignette describes how to use Microsoft365R to interact with <a href="https://www.microsoft.com/en-au/microsoft-365/outlook/email-and-calendar-software-microsoft-outlook" class="external-link">Outlook</a>
for managing and sending email. See the “Authenticating to Microsoft
365” vignette for more details on authentication if required.</p>
<p>Note that Microsoft365R only works with your <em>primary</em> Outlook
(Microsoft Exchange) account. It does not support other email providers
that you may have connected to your Outlook account, eg Gmail.</p>
<div class="section level2">
<h2 id="outlook-client">Outlook client<a class="anchor" aria-label="anchor" href="#outlook-client"></a>
</h2>
<p>To access your Outlook inbox, call either
<code><a href="../reference/client.html">get_personal_outlook()</a></code> or
<code><a href="../reference/client.html">get_business_outlook()</a></code>. The first one is for your personal
account, and the second is for your work &amp; school account. They
return objects of R6 class <code>ms_outlook</code>, which has methods
for drafting new emails, listing emails in your Inbox, and working with
folders.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/client.html">get_personal_outlook</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">outlb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/client.html">get_business_outlook</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># list the most recent emails in your Inbox</span></span>
<span><span class="va">outl</span><span class="op">$</span><span class="fu">list_emails</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create and send a new email</span></span>
<span><span class="va">outl</span><span class="op">$</span><span class="fu">create_email</span><span class="op">(</span><span class="st">"Hello from R"</span>, subject<span class="op">=</span><span class="st">"Hello"</span>, to<span class="op">=</span><span class="st">"bob@example.com"</span><span class="op">)</span><span class="op">$</span><span class="fu">send</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># list your mail folders</span></span>
<span><span class="va">outl</span><span class="op">$</span><span class="fu">list_folders</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get some common folders</span></span>
<span><span class="va">inbox</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span><span class="fu">get_inbox</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">drafts</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span><span class="fu">get_drafts</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">sent</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span><span class="fu">get_sent_items</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">deleted</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span><span class="fu">get_deleted_items</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get a specific folder by name</span></span>
<span><span class="va">folder</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span><span class="fu">get_folder</span><span class="op">(</span><span class="st">"myfolder"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="writing-emails">Writing emails<a class="anchor" aria-label="anchor" href="#writing-emails"></a>
</h2>
<p>To write a new email, call the <code>create_email()</code> method as
noted above; this returns an object of R6 class
<code>ms_outlook_email</code>. You can create a blank email which you
then edit using the object’s methods, or supply the details in the
<code>create_email()</code> call itself. The message will be saved in
the Drafts folder.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a draft email</span></span>
<span><span class="va">em</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span><span class="fu">create_email</span><span class="op">(</span><span class="st">"Hello from R"</span>, subject<span class="op">=</span><span class="st">"Hello"</span>,</span>
<span>    to<span class="op">=</span><span class="st">"bob@example.com"</span>, cc<span class="op">=</span><span class="st">"charlie@example.com"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># or: create a blank draft, then add details</span></span>
<span><span class="va">em</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span><span class="fu">create_email</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">em</span><span class="op">$</span><span class="fu">set_body</span><span class="op">(</span><span class="st">"Hello from R"</span><span class="op">)</span></span>
<span><span class="va">em</span><span class="op">$</span><span class="fu">set_subject</span><span class="op">(</span><span class="st">"Hello"</span><span class="op">)</span></span>
<span><span class="va">em</span><span class="op">$</span><span class="fu">set_recipients</span><span class="op">(</span>to<span class="op">=</span><span class="st">"bob@example.com"</span>, cc<span class="op">=</span><span class="st">"charlie@example.com"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># alternatively, use method chaining to achieve the same thing</span></span>
<span><span class="va">em</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span></span>
<span>    <span class="fu">create_email</span><span class="op">(</span><span class="op">)</span><span class="op">$</span></span>
<span>    <span class="fu">set_body</span><span class="op">(</span><span class="st">"Hello from R"</span><span class="op">)</span><span class="op">$</span></span>
<span>    <span class="fu">set_subject</span><span class="op">(</span><span class="st">"Hello"</span><span class="op">)</span><span class="op">$</span></span>
<span>    <span class="fu">set_recipients</span><span class="op">(</span>to<span class="op">=</span><span class="st">"bob@example.com"</span>, cc<span class="op">=</span><span class="st">"charlie@example.com"</span><span class="op">)</span></span></code></pre></div>
<p>In the example above, the email has a plain text message body which
is the default. To create an email in HTML format, set the
<code>content_type</code> argument to “html”.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">em</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span><span class="fu">create_email</span><span class="op">(</span><span class="st">"&lt;h2&gt;Hello world!&lt;/h2&gt;"</span>, content_type<span class="op">=</span><span class="st">"html"</span><span class="op">)</span></span></code></pre></div>
<p>However, Microsoft365R also supports using the blastula and emayili
packages to write nicely-formatted HTML emails. In particular, blastula
lets you compose your email in Markdown, which is often easier than
writing raw HTML.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bl_body</span> <span class="op">&lt;-</span> <span class="st">"## Hello!</span></span>
<span><span class="st"></span></span>
<span><span class="st">This is an email message that was generated by the blastula package.</span></span>
<span><span class="st"></span></span>
<span><span class="st">We can use **Markdown** formatting with the `md()` function.</span></span>
<span><span class="st"></span></span>
<span><span class="st">Cheers,</span></span>
<span><span class="st"></span></span>
<span><span class="st">The blastula team"</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/blastula" class="external-link">blastula</a></span><span class="op">)</span></span>
<span><span class="va">bl_em</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/blastula/man/compose_email.html" class="external-link">compose_email</a></span><span class="op">(</span></span>
<span>    body<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/blastula/man/md.html" class="external-link">md</a></span><span class="op">(</span><span class="va">bl_body</span><span class="op">)</span>,</span>
<span>    footer<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/blastula/man/md.html" class="external-link">md</a></span><span class="op">(</span><span class="st">"sent via Microsoft365R"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">em</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span><span class="fu">create_email</span><span class="op">(</span><span class="va">bl_em</span>, subject<span class="op">=</span><span class="st">"Hello"</span>, to<span class="op">=</span><span class="st">"bob@example.com"</span><span class="op">)</span></span></code></pre></div>
<p>Once the message is created, you send it with its <code>send()</code>
method. Sending an email will move it to the Sent Items folder.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">em</span><span class="op">$</span><span class="fu">send</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="attachments">Attachments<a class="anchor" aria-label="anchor" href="#attachments"></a>
</h3>
<p>You can add file attachments to a draft email with the
<code><a href="https://rdrr.io/pkg/blastula/man/add_attachment.html" class="external-link">add_attachment()</a></code> method. The attachment can be located on
your local machine or in OneDrive/SharePoint. In the latter case, you
should supply a drive item object, along with the details for how it
should be shared: a OneDrive/Sharepoint file is actually attached as a
shared link, and you can specify things like whether to make a viewable
or editable link, the expiry time, whether a password is required, and
so on.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># attach a file on your local machine</span></span>
<span><span class="va">em</span><span class="op">$</span><span class="fu">add_attachment</span><span class="op">(</span><span class="st">"mydocument.docx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># attach a file in OneDrive/SharePoint: an editable link, valid for 1 month</span></span>
<span><span class="va">item</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/client.html">get_sharepoint_site</a></span><span class="op">(</span><span class="st">"My site"</span><span class="op">)</span><span class="op">$</span></span>
<span>    <span class="fu">get_drive</span><span class="op">(</span><span class="op">)</span><span class="op">$</span></span>
<span>    <span class="fu">get_item</span><span class="op">(</span><span class="st">"Documents/myproject.pptx"</span><span class="op">)</span></span>
<span><span class="va">em</span><span class="op">$</span><span class="fu">att_attachment</span><span class="op">(</span><span class="va">item</span>, type<span class="op">=</span><span class="st">"edit"</span>, expiry<span class="op">=</span><span class="st">"1 month"</span><span class="op">)</span></span></code></pre></div>
<p>The “OneDrive and SharePoint” vignette has more information on drive
item objects, including the arguments for creating shared links.</p>
<p>You can also add an image file as an <em>inline</em> attachment with
the <code><a href="https://rdrr.io/pkg/blastula/man/add_image.html" class="external-link">add_image()</a></code> method. The image will be placed at the end
of the message body, which should be in HTML format. Currently
Microsoft365R does minimal formatting of the inline image; for more
control over layout details, consider using the similar feature in the
blastula package.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># add an inline image: note the email message body must be HTML</span></span>
<span><span class="va">em</span> <span class="op">&lt;-</span> <span class="fu">create_email</span><span class="op">(</span><span class="st">"See picture below"</span>, content_type<span class="op">=</span><span class="st">"html"</span><span class="op">)</span></span>
<span><span class="va">em</span><span class="op">$</span><span class="fu">add_image</span><span class="op">(</span><span class="st">"mypicture.jpg"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># or with blastula</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/blastula" class="external-link">blastula</a></span><span class="op">)</span></span>
<span><span class="va">bl_body</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/blastula/man/md.html" class="external-link">md</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"See picture below"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/blastula/man/add_image.html" class="external-link">add_image</a></span><span class="op">(</span><span class="st">"mypicture.jpg"</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bl_em</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/blastula/man/compose_email.html" class="external-link">compose_email</a></span><span class="op">(</span><span class="va">bl_body</span><span class="op">)</span></span>
<span><span class="va">em</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span><span class="fu">create_email</span><span class="op">(</span><span class="va">bl_em</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="other-methods">Other methods<a class="anchor" aria-label="anchor" href="#other-methods"></a>
</h3>
<p>In addition to the methods noted above, an email message object has
the following methods for editing its contents:</p>
<ul>
<li>
<code>add_recipients(to, cc, from)</code>: Adds recipients to the
email. Unlike <code>set_recipients()</code> which was used before, this
will retain any existing recipients rather than deleting them.</li>
<li>
<code>set_reply_to()</code>: Sets the reply-to email address for the
email.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="managing-your-emails">Managing your emails<a class="anchor" aria-label="anchor" href="#managing-your-emails"></a>
</h2>
<p>The Outlook client <code>list_emails()</code> method by default
returns a list of the 50 most recent emails in your Inbox, sorted by
date received. Each email is an object of class
<code>ms_outlook_email</code>, the same as for messages that you send.
You can customise the list to set the number of emails returned, and the
criterion for retrieving them: by date, sender or subject.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># a list of 50 email objects</span></span>
<span><span class="va">outl</span><span class="op">$</span><span class="fu">list_emails</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 100 most recent emails</span></span>
<span><span class="va">outl</span><span class="op">$</span><span class="fu">list_emails</span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 50 emails, sorted by sender in ascending order</span></span>
<span><span class="va">outl</span><span class="op">$</span><span class="fu">list_emails</span><span class="op">(</span>by<span class="op">=</span><span class="st">"from"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 200 emails, sorted by subject in descending order</span></span>
<span><span class="va">outl</span><span class="op">$</span><span class="fu">list_emails</span><span class="op">(</span>by<span class="op">=</span><span class="st">"subject desc"</span>, n<span class="op">=</span><span class="fl">200</span><span class="op">)</span></span></code></pre></div>
<p>A specific email object can be retrieved with
<code>get_email()</code>. However, as this requires knowing its Outlook
message ID, it will usually be easier to examine the result of
<code>list_emails()</code> to get the email desired.</p>
<p>You can list the attachments for an email with
<code>list_attachments()</code>, retrieve the metadata for an attachment
with <code>get_attachment()</code>, and download the attachment with
<code>download_attachment()</code>. Note that these methods work both
for messages that you send, and those that you’ve received.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the most recent email</span></span>
<span><span class="va">em</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span><span class="fu">list_emails</span><span class="op">(</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># a list of the attachments for the email</span></span>
<span><span class="va">em</span><span class="op">$</span><span class="fu">list_attachments</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get a single attachment object</span></span>
<span><span class="va">em</span><span class="op">$</span><span class="fu">get_attachment</span><span class="op">(</span><span class="st">"myfile.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># download it</span></span>
<span><span class="va">em</span><span class="op">$</span><span class="fu">download_attachment</span><span class="op">(</span><span class="st">"myfile.csv"</span><span class="op">)</span></span></code></pre></div>
<p>To delete an email, simply call its <code>delete()</code> method. By
default, this will prompt you for confirmation first. The email will be
moved to the Deleted Items folder.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">em</span><span class="op">$</span><span class="fu">delete</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="replying-to-an-email">Replying to an email<a class="anchor" aria-label="anchor" href="#replying-to-an-email"></a>
</h3>
<p>An email object has <code>create_reply()</code>,
<code>create_reply_all()</code> and <code>create_forward()</code>
methods for creating replies and forwarding. The first argument is the
reply comment, which is inserted above the quoted message body of the
original email. Each of these creates a new draft email, and the methods
described in “Writing emails” above apply here as well.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the most recent email in the Inbox</span></span>
<span><span class="va">em</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span><span class="fu">list_emails</span><span class="op">(</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># draft a reply to it, adding an attachment</span></span>
<span><span class="va">repl</span> <span class="op">&lt;-</span> <span class="va">em</span><span class="op">$</span><span class="fu">create_reply</span><span class="op">(</span><span class="st">"See attached report"</span><span class="op">)</span><span class="op">$</span></span>
<span>    <span class="fu">add_attachment</span><span class="op">(</span><span class="st">"report.md"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># reply-all, setting the reply-to address</span></span>
<span><span class="va">repl_all</span> <span class="op">&lt;-</span> <span class="va">em</span><span class="op">$</span><span class="fu">create_reply_all</span><span class="op">(</span><span class="st">"Please do not reply"</span><span class="op">)</span><span class="op">$</span></span>
<span>    <span class="fu">set_reply_to</span><span class="op">(</span><span class="st">"do_not_reply@example.com"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># or forward it</span></span>
<span><span class="va">fwd</span> <span class="op">&lt;-</span> <span class="va">em</span><span class="op">$</span><span class="fu">create_forward</span><span class="op">(</span><span class="st">"FYI"</span>, to<span class="op">=</span><span class="st">"mallory@example.com"</span><span class="op">)</span></span></code></pre></div>
<p>As with drafting new emails, you send a reply by calling its
<code>send()</code> method:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">repl</span><span class="op">$</span><span class="fu">send</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">repl_all</span><span class="op">$</span><span class="fu">send</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">fwd</span><span class="op">$</span><span class="fu">send</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Also as with writing new emails, you can use blastula and emayili to
create the reply comment:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/blastula" class="external-link">blastula</a></span><span class="op">)</span></span>
<span><span class="va">bl_repl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/blastula/man/compose_email.html" class="external-link">compose_email</a></span><span class="op">(</span></span>
<span>    body<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/blastula/man/md.html" class="external-link">md</a></span><span class="op">(</span><span class="st">"This is a **good idea!**"</span><span class="op">)</span>,</span>
<span>    footer<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/blastula/man/md.html" class="external-link">md</a></span><span class="op">(</span><span class="st">"sent via Microsoft365R"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">em</span><span class="op">$</span><span class="fu">create_reply</span><span class="op">(</span><span class="va">bl_repl</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="working-with-folders">Working with folders<a class="anchor" aria-label="anchor" href="#working-with-folders"></a>
</h3>
<p>Microsoft365R provides a rich set of tools for managing your email
folders. A folder is represented by an object of R6 class
<code>ms_outlook_folder</code>, which has methods for listing emails,
drafting replies, and copying and moving items.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># list all the folders in your account</span></span>
<span><span class="va">outl</span><span class="op">$</span><span class="fu">list_folders</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get a folder by name</span></span>
<span><span class="va">folder</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span><span class="fu">get_folder</span><span class="op">(</span><span class="st">"myfolder"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># you can also get nested folders</span></span>
<span><span class="va">folder2</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span><span class="fu">get_folder</span><span class="op">(</span><span class="st">"top level"</span><span class="op">)</span><span class="op">$</span><span class="fu">get_folder</span><span class="op">(</span><span class="st">"2nd level"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create a new folder</span></span>
<span><span class="va">outl</span><span class="op">$</span><span class="fu">create_folder</span><span class="op">(</span><span class="st">"test folder"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># delete it</span></span>
<span><span class="va">outl</span><span class="op">$</span><span class="fu">delete_folder</span><span class="op">(</span><span class="st">"test folder"</span><span class="op">)</span></span></code></pre></div>
<p>In addition, the Outlook client object provides some convenience
functions for retrieving well-known folders: <code>get_inbox()</code>,
<code>get_drafts()</code>, <code>get_sent_items()</code>, and
<code>get_deleted_items()</code>.</p>
<p>To list the emails in a folder, call its <code>list_emails()</code>
method. This has the same arguments as the <code>list_emails()</code>
method for the Outlook client object; in fact, the latter simply calls
the folder method for the Inbox folder.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># list all the emails in the Inbox -- the same as outl$list_emails()</span></span>
<span><span class="va">outl</span><span class="op">$</span><span class="fu">get_inbox</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">list_emails</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># list all the emails in a specific folder</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="fu">get_folder</span><span class="op">(</span><span class="st">"myfolder"</span><span class="op">)</span><span class="op">$</span><span class="fu">list_emails</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Similarly, to create a new draft email in a folder, call its
<code>create_email()</code> method. Again, this has the same arguments
as the Outlook client object method, which calls the folder method for
the Drafts folder.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a new email in Drafts  -- same as outl$create_email()</span></span>
<span><span class="va">outl</span><span class="op">$</span><span class="fu">get_drafts</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">create_email</span><span class="op">(</span><span class="st">"Hello from R"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create a new email in a specific folder</span></span>
<span><span class="va">outl</span><span class="op">$</span><span class="fu">get_folder</span><span class="op">(</span><span class="st">"myfolder"</span><span class="op">)</span><span class="op">$</span><span class="fu">create_email</span><span class="op">(</span><span class="st">"Hello from R"</span><span class="op">)</span></span></code></pre></div>
<p>You can move and copy folder items by calling their
<code>move()</code> and <code>copy()</code> methods. This works for both
emails and (nested) folders. The destination should be another folder
object.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">destfolder</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span><span class="fu">get_folder</span><span class="op">(</span><span class="st">"my archive"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># copying an email</span></span>
<span><span class="va">em</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span><span class="fu">list_emails</span><span class="op">(</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">em</span><span class="op">$</span><span class="fu">copy</span><span class="op">(</span><span class="va">destfolder</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># moving a folder</span></span>
<span><span class="va">folder</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span><span class="fu">get_folder</span><span class="op">(</span><span class="st">"test folder"</span><span class="op">)</span></span>
<span><span class="va">folder</span><span class="op">$</span><span class="fu">move</span><span class="op">(</span><span class="va">destfolder</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Hong Ooi.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
