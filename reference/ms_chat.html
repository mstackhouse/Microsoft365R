<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Teams chat — ms_chat • Microsoft365R</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Teams chat — ms_chat"><meta property="og:description" content="Class representing a one-on-one, group or meeting chat in Microsoft Teams."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Microsoft365R</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.4.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/auth.html">Authenticating to Microsoft 365</a>
    </li>
    <li>
      <a href="../articles/od_sp.html">OneDrive and SharePoint</a>
    </li>
    <li>
      <a href="../articles/outlook.html">Managing emails with Outlook</a>
    </li>
    <li>
      <a href="../articles/scripted.html">Using Microsoft365R in an unattended script</a>
    </li>
    <li>
      <a href="../articles/shiny.html">Using Microsoft365R in a Shiny app</a>
    </li>
    <li>
      <a href="../articles/teams.html">Teams</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Azure/Microsoft365R/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Teams chat</h1>
    <small class="dont-index">Source: <a href="https://github.com/Azure/Microsoft365R/blob/HEAD/R/ms_chat.R" class="external-link"><code>R/ms_chat.R</code></a></small>
    <div class="hidden name"><code>ms_chat.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Class representing a one-on-one, group or meeting chat in Microsoft Teams.</p>
    </div>


    <div id="format">
    <h2>Format</h2>
    <p>An R6 object of class <code>ms_chat</code>, inheriting from <code>ms_object</code>.</p>
    </div>
    <div id="fields">
    <h2>Fields</h2>
    

<ul><li><p><code>token</code>: The token used to authenticate with the Graph host.</p></li>
<li><p><code>tenant</code>: The Azure Active Directory tenant for the parent drive.</p></li>
<li><p><code>type</code>: Always "chat" for a chat object.</p></li>
<li><p><code>properties</code>: The item properties (metadata).</p></li>
</ul></div>
    <div id="methods">
    <h2>Methods</h2>
    

<ul><li><p><code>new(...)</code>: Initialize a new object. Do not call this directly; see 'Initialization' below.</p></li>
<li><p><code>update(...)</code>: Update the chat's properties (metadata) in Microsoft Graph.</p></li>
<li><p><code>do_operation(...)</code>: Carry out an arbitrary operation on the chat.</p></li>
<li><p><code>sync_fields()</code>: Synchronise the R object with the chat metadata in Microsoft Graph.</p></li>
<li><p><code>send_message(body, content_type, attachments)</code>: Sends a new message to the chat. See below.</p></li>
<li><p><code>list_messages(filter=NULL, n=50)</code>: Retrieves the messages in the chat. By default, this is limited to the 50 most recent messages; set the <code>n</code> argument to change this.</p></li>
<li><p><code>get_message(message_id)</code>: Retrieves a specific message in the chat.</p></li>
<li><p><code>delete_message(message_id, confirm=TRUE)</code>: Deletes a message. Currently the Graph API does not support deleting Teams messages, so this method is disabled.</p></li>
<li><p><code>list_members(filter=NULL, n=Inf)</code>: Retrieves the members of the chat, as a list of <code><a href="ms_team_member.html">ms_team_member</a></code> objects.</p></li>
<li><p><code>get_member(name, email, id)</code>: Retrieve a specific member of the chat, as a <code>ms_team_member</code> object. Supply only one of the member name, email address or ID.</p></li>
</ul></div>
    <div id="initialization">
    <h2>Initialization</h2>
    

<p>Creating new objects of this class should be done via the <code>get_chat</code> and <code>list_chats</code> methods of the <code><a href="ms_team.html">ms_team</a></code> class. Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to retrieve or create the actual chat.</p>
    </div>
    <div id="messaging">
    <h2>Messaging</h2>
    

<p>To send a message to a chat, use the <code>send_message()</code> method. This has arguments:</p><ul><li><p><code>body</code>: The body of the message. This should be a character vector, which will be concatenated into a single string with newline separators. The body can be either plain text or HTML formatted.</p></li>
<li><p><code>content_type</code>: Either "text" (the default) or "html".</p></li>
<li><p><code>attachments</code>: Optional vector of filenames.</p></li>
<li><p><code>inline</code>: Optional vector of image filenames that will be inserted into the body of the message. The images must be PNG or JPEG, and the <code>content_type</code> argument must be "html" to include inline content.</p></li>
<li><p><code>mentions</code>: Optional vector of @mentions that will be inserted into the body of the message. This should be either an object of one of the following classes, or a list of the same: <code>az_user</code>, <code><a href="ms_team.html">ms_team</a></code>, <code><a href="ms_channel.html">ms_channel</a></code>, <code><a href="ms_team_member.html">ms_team_member</a></code>. The <code>content_type</code> argument must be "html" to include mentions.</p></li>
</ul><p>Message attachments are uploaded to your OneDrive for Business, in the folder "Microsoft Teams Chat Files". This is the same method as used by the regular Teams app. Unlike the Teams app, no localisation is performed, so the folder is always the same regardless of your language settings. As with channels, support for attachments is still somewhat experimental so please report any bugs found.</p>
    </div>
    <div id="list-methods">
    <h2>List methods</h2>
    

<p>All <code>list_*</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://learn.microsoft.com/en-us/graph/query-parameters#filter-parameter" class="external-link">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="ms_team.html">ms_team</a></code>, <code><a href="ms_drive.html">ms_drive</a></code>, <code>ms_chat</code>, <code><a href="ms_chat_message.html">ms_chat_message</a></code></p>
<p><a href="https://learn.microsoft.com/en-us/graph/overview" class="external-link">Microsoft Graph overview</a>,
<a href="https://learn.microsoft.com/en-us/graph/api/resources/teams-api-overview?view=graph-rest-1.0" class="external-link">Microsoft Teams API reference</a></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">chat</span> <span class="op">&lt;-</span> <span class="fu"><a href="client.html">get_chat</a></span><span class="op">(</span><span class="st">"chat-id"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># a multi-line message with an attachment</span></span></span>
<span class="r-in"><span><span class="va">msg_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"message line 1"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"message line 2"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"message line 3"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">chat</span><span class="op">$</span><span class="fu">send_message</span><span class="op">(</span><span class="va">msg_text</span>, attachments<span class="op">=</span><span class="st">"myfile.csv"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># sending an inline image</span></span></span>
<span class="r-in"><span><span class="va">chat</span><span class="op">$</span><span class="fu">send_message</span><span class="op">(</span><span class="st">""</span>, content_type<span class="op">=</span><span class="st">"html"</span>, inline<span class="op">=</span><span class="st">"graph.png"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># chat members</span></span></span>
<span class="r-in"><span><span class="va">chat</span><span class="op">$</span><span class="fu">list_members</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">jane</span> <span class="op">&lt;-</span> <span class="va">chat</span><span class="op">$</span><span class="fu">get_member</span><span class="op">(</span><span class="st">"Jane Smith"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bill</span> <span class="op">&lt;-</span> <span class="va">chat</span><span class="op">$</span><span class="fu">get_member</span><span class="op">(</span>email<span class="op">=</span><span class="st">"billg@mycompany.com"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># mentioning a team member</span></span></span>
<span class="r-in"><span><span class="va">chat</span><span class="op">$</span><span class="fu">send_message</span><span class="op">(</span><span class="st">"Here is a message"</span>, content_type<span class="op">=</span><span class="st">"html"</span>, mentions<span class="op">=</span><span class="va">jane</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># mentioning 2 or more members: use a list</span></span></span>
<span class="r-in"><span><span class="va">chat</span><span class="op">$</span><span class="fu">send_message</span><span class="op">(</span><span class="st">"Here is another message"</span>, content_type<span class="op">=</span><span class="st">"html"</span>,</span></span>
<span class="r-in"><span>    mentions<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">jane</span>, <span class="va">bill</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Hong Ooi.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

