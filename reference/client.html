<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Login clients for Microsoft 365 — get_personal_onedrive • Microsoft365R</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Login clients for Microsoft 365 — get_personal_onedrive"><meta property="og:description" content="Microsoft365R provides functions for logging into each Microsoft 365 service."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Microsoft365R</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/auth.html">Authenticating to Microsoft 365</a>
    </li>
    <li>
      <a href="../articles/od_sp.html">OneDrive and SharePoint</a>
    </li>
    <li>
      <a href="../articles/outlook.html">Managing emails with Outlook</a>
    </li>
    <li>
      <a href="../articles/scripted.html">Using Microsoft365R in an unattended script</a>
    </li>
    <li>
      <a href="../articles/shiny.html">Using Microsoft365R in a Shiny app</a>
    </li>
    <li>
      <a href="../articles/teams.html">Teams</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Azure/Microsoft365R/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Login clients for Microsoft 365</h1>
    <small class="dont-index">Source: <a href="https://github.com/Azure/Microsoft365R/blob/HEAD/R/client.R" class="external-link"><code>R/client.R</code></a></small>
    <div class="hidden name"><code>client.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Microsoft365R provides functions for logging into each Microsoft 365 service.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">get_personal_onedrive</span><span class="op">(</span>
  app <span class="op">=</span> <span class="va">.microsoft365r_app_id</span>,
  scopes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Files.ReadWrite.All"</span>, <span class="st">"User.Read"</span><span class="op">)</span>,
  token <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu">get_business_onedrive</span><span class="op">(</span>
  tenant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"CLIMICROSOFT365_TENANT"</span>, <span class="st">"common"</span><span class="op">)</span>,
  app <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"CLIMICROSOFT365_AADAPPID"</span><span class="op">)</span>,
  scopes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Files.ReadWrite.All"</span>, <span class="st">"User.Read"</span><span class="op">)</span>,
  token <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu">get_sharepoint_site</span><span class="op">(</span>
  site_name <span class="op">=</span> <span class="cn">NULL</span>,
  site_url <span class="op">=</span> <span class="cn">NULL</span>,
  site_id <span class="op">=</span> <span class="cn">NULL</span>,
  tenant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"CLIMICROSOFT365_TENANT"</span>, <span class="st">"common"</span><span class="op">)</span>,
  app <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"CLIMICROSOFT365_AADAPPID"</span><span class="op">)</span>,
  scopes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group.ReadWrite.All"</span>, <span class="st">"Directory.Read.All"</span>, <span class="st">"Sites.ReadWrite.All"</span>,
    <span class="st">"Sites.Manage.All"</span><span class="op">)</span>,
  token <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu">list_sharepoint_sites</span><span class="op">(</span>
  tenant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"CLIMICROSOFT365_TENANT"</span>, <span class="st">"common"</span><span class="op">)</span>,
  app <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"CLIMICROSOFT365_AADAPPID"</span><span class="op">)</span>,
  scopes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group.ReadWrite.All"</span>, <span class="st">"Directory.Read.All"</span>, <span class="st">"Sites.ReadWrite.All"</span>,
    <span class="st">"Sites.Manage.All"</span><span class="op">)</span>,
  token <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu">get_team</span><span class="op">(</span>
  team_name <span class="op">=</span> <span class="cn">NULL</span>,
  team_id <span class="op">=</span> <span class="cn">NULL</span>,
  tenant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"CLIMICROSOFT365_TENANT"</span>, <span class="st">"common"</span><span class="op">)</span>,
  app <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"CLIMICROSOFT365_AADAPPID"</span><span class="op">)</span>,
  scopes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group.ReadWrite.All"</span>, <span class="st">"Directory.Read.All"</span><span class="op">)</span>,
  token <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu">list_teams</span><span class="op">(</span>
  tenant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"CLIMICROSOFT365_TENANT"</span>, <span class="st">"common"</span><span class="op">)</span>,
  app <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"CLIMICROSOFT365_AADAPPID"</span><span class="op">)</span>,
  scopes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group.ReadWrite.All"</span>, <span class="st">"Directory.Read.All"</span><span class="op">)</span>,
  token <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu">get_personal_outlook</span><span class="op">(</span>
  app <span class="op">=</span> <span class="va">.microsoft365r_app_id</span>,
  scopes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mail.Send"</span>, <span class="st">"Mail.ReadWrite"</span>, <span class="st">"User.Read"</span><span class="op">)</span>,
  token <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu">get_business_outlook</span><span class="op">(</span>
  tenant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"CLIMICROSOFT365_TENANT"</span>, <span class="st">"common"</span><span class="op">)</span>,
  app <span class="op">=</span> <span class="va">.microsoft365r_app_id</span>,
  shared_mbox_id <span class="op">=</span> <span class="cn">NULL</span>,
  shared_mbox_name <span class="op">=</span> <span class="cn">NULL</span>,
  shared_mbox_email <span class="op">=</span> <span class="cn">NULL</span>,
  scopes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"User.Read"</span>, <span class="st">"Mail.Send"</span>, <span class="st">"Mail.ReadWrite"</span><span class="op">)</span>,
  token <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu">get_chat</span><span class="op">(</span>
  <span class="va">chat_id</span>,
  tenant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"CLIMICROSOFT365_TENANT"</span>, <span class="st">"common"</span><span class="op">)</span>,
  app <span class="op">=</span> <span class="va">.microsoft365r_app_id</span>,
  scopes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"User.Read"</span>, <span class="st">"Directory.Read.All"</span>, <span class="st">"Chat.ReadWrite"</span><span class="op">)</span>,
  token <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu">list_chats</span><span class="op">(</span>
  tenant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"CLIMICROSOFT365_TENANT"</span>, <span class="st">"common"</span><span class="op">)</span>,
  app <span class="op">=</span> <span class="va">.microsoft365r_app_id</span>,
  scopes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"User.Read"</span>, <span class="st">"Directory.Read.All"</span>, <span class="st">"Chat.ReadWrite"</span><span class="op">)</span>,
  token <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>app</dt>
<dd><p>A custom app registration ID to use for authentication. See below.</p></dd>
<dt>scopes</dt>
<dd><p>The Microsoft Graph scopes (permissions) to obtain. It should never be necessary to change these.</p></dd>
<dt>token</dt>
<dd><p>An AAD OAuth token object, of class <code><a href="https://rdrr.io/pkg/AzureAuth/man/AzureToken.html" class="external-link">AzureAuth::AzureToken</a></code>. If supplied, the <code>tenant</code>, <code>app</code>, <code>scopes</code> and <code>...</code> arguments will be ignored. See "Authenticating with a token" below.</p></dd>
<dt>...</dt>
<dd><p>Optional arguments that will ultimately be passed to <code><a href="https://rdrr.io/pkg/AzureAuth/man/get_azure_token.html" class="external-link">AzureAuth::get_azure_token</a></code>.</p></dd>
<dt>tenant</dt>
<dd><p>For <code>get_business_onedrive</code>, <code>get_sharepoint_site</code> and <code>get_team</code>, the name of your Azure Active Directory (AAD) tenant. If not supplied, use the value of the <code>CLIMICROSOFT365_TENANT</code> environment variable, or "common" if that is unset.</p></dd>
<dt>site_name, site_url, site_id</dt>
<dd><p>For <code>get_sharepoint_site</code>, either the name, web URL or ID of the SharePoint site to retrieve. Supply exactly one of these.</p></dd>
<dt>team_name, team_id</dt>
<dd><p>For <code>get_team</code>, either the name or ID of the team to retrieve. Supply exactly one of these.</p></dd>
<dt>shared_mbox_id, shared_mbox_name, shared_mbox_email</dt>
<dd><p>For <code>get_business_outlook</code>, an ID/principal name/email address. Supply exactly one of these to retrieve a shared mailbox. If all are NULL (the default), retrieve your own mailbox.</p></dd>
<dt>chat_id</dt>
<dd><p>For <code>get_chat</code>, the ID of a group, one-on-one or meeting chat in Teams.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>For <code>get_personal_onedrive</code> and <code>get_business_onedrive</code>, an R6 object of class <code>ms_drive</code>.
For <code>get_sharepoint_site</code>, an R6 object of class <code>ms_site</code>; for <code>list_sharepoint_sites</code>, a list of such objects.
For <code>get_team</code>, an R6 object of class <code>ms_team</code>; for <code>list_teams</code>, a list of such objects.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>These functions provide easy access to the various collaboration services that are part of Microsoft 365. On first use, they will call your web browser to authenticate with Azure Active Directory, in a similar manner to other web apps. You will get a dialog box asking for permission to access your information. You only have to authenticate once; your credentials will be saved and reloaded in subsequent sessions.</p>
<p>When authenticating, you can pass optional arguments in <code>...</code> which will ultimately be received by <code><a href="https://rdrr.io/pkg/AzureAuth/man/get_azure_token.html" class="external-link">AzureAuth::get_azure_token</a></code>. In particular, if your machine doesn't have a web browser available to authenticate with (for example if you are in a remote RStudio Server session), pass <code>auth_type="device_code"</code> which is intended for such scenarios.</p><div class="section">
<h3 id="authenticating-to-microsoft-business-services">Authenticating to Microsoft 365 Business services<a class="anchor" aria-label="anchor" href="#authenticating-to-microsoft-business-services"></a></h3>


<p>Authenticating to Microsoft 365 Business services (Teams, SharePoint and business OneDrive/Outlook) has some specific complexities.</p>
<p>The default "common" tenant for <code>get_team</code>, <code>get_business_onedrive</code> and <code>get_sharepoint_site</code> attempts to detect your actual tenant from your saved credentials in your browser. This may not always succeed, for example if you have a personal account that is also a guest account in a tenant. In this case, supply the actual tenant name, either in the <code>tenant</code> argument or in the <code>CLIMICROSOFT365_TENANT</code> environment variable. The latter allows sharing authentication details with the <a href="https://pnp.github.io/cli-microsoft365/" class="external-link">CLI for Microsoft 365</a>.</p>
<p>The default when authenticating to these services is for Microsoft365R to use its own internal app ID. As an alternative, you (or your admin) can create your own app registration in Azure: for use in a local session, it should have a native redirect URI of <code>http://localhost:1410</code>, and the "public client" option should be enabled if you want to use the device code authentication flow. You can supply your app ID either via the <code>app</code> argument, or in the environment variable <code>CLIMICROSOFT365_AADAPPID</code>.</p>
</div>

<div class="section">
<h3 id="authenticating-with-a-token">Authenticating with a token<a class="anchor" aria-label="anchor" href="#authenticating-with-a-token"></a></h3>


<p>In some circumstances, it may be desirable to carry out authentication/authorization as a separate step prior to  making requests to the Microsoft 365 REST API. This holds in a Shiny app, for example, since only the UI part can talk to the browser while the server part does the rest of the work. Another scenario is if the refresh token lifetime set by your org is too short, so that the token expires in between R sessions.</p>
<p>In this case, you can authenticate by obtaining a new token with <code><a href="https://rdrr.io/pkg/AzureAuth/man/get_azure_token.html" class="external-link">AzureAuth::get_azure_token</a></code>, and passing the token object to the client function. Note that the token is accepted as-is; no checks are performed that it has the correct permissions for the service you're using.</p>
<p>When calling <code>get_azure_token</code>, the scopes you should use are those given in the <code>scopes</code> argument for each client function, and the API host is <code>https://graph.microsoft.com/</code>. The Microsoft365R internal app ID is <code>d44a05d5-c6a5-4bbb-82d2-443123722380</code>, while that for the CLI for Microsoft 365 is <code>31359c7f-bd7e-475c-86db-fdb8c937548e</code>. However, these app IDs <strong>only</strong> work for a local R session; you must create your own app registration if you want to use the package inside a Shiny app.</p>
<p>See the examples below, and also the vignette "Using Microsoft365R in a Shiny app" for a more detailed rundown on combining Microsoft365R and Shiny.</p>
</div>

<div class="section">
<h3 id="clearing-the-cache">Clearing the cache<a class="anchor" aria-label="anchor" href="#clearing-the-cache"></a></h3>


<p>Deleting your cached credentials is a way of rebooting the authentication process, if you are repeatedly encountering errors. To do this, call <code><a href="https://rdrr.io/pkg/AzureAuth/man/get_azure_token.html" class="external-link">AzureAuth::clean_token_directory</a></code>, then try logging in again. You may also need to clear your browser's cookies, if you are authenticating interactively.</p>
</div>

    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="ms_drive.html">ms_drive</a></code>, <code><a href="ms_site.html">ms_site</a></code>, <code><a href="ms_team.html">ms_team</a></code>, <code><a href="ms_chat.html">ms_chat</a></code></p>
<p><code><a href="add_methods.html">add_methods</a></code> for the associated methods that this package adds to the base AzureGraph classes.</p>
<p>The "Authentication" vignette has more details on the authentication process, including troubleshooting and fixes for common problems. The "Using Microsoft365R in a Shiny app" vignette has further Shiny-specific information, including how to configure the necessary app registration in Azure Active Directory.</p>
<p><a href="https://pnp.github.io/cli-microsoft365/" class="external-link">CLI for Microsoft 365</a> -- a commandline tool for managing Microsoft 365</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">get_personal_onedrive</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># authenticating without a browser</span></span>
<span class="r-in"><span class="fu">get_personal_onedrive</span><span class="op">(</span>auth_type<span class="op">=</span><span class="st">"device_code"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">odb</span> <span class="op">&lt;-</span> <span class="fu">get_business_onedrive</span><span class="op">(</span><span class="st">"mycompany"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">odb</span><span class="op">$</span><span class="fu">list_items</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">mysite</span> <span class="op">&lt;-</span> <span class="fu">get_sharepoint_site</span><span class="op">(</span><span class="st">"My site"</span>, tenant<span class="op">=</span><span class="st">"mycompany"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">mysite</span> <span class="op">&lt;-</span> <span class="fu">get_sharepoint_site</span><span class="op">(</span>site_url<span class="op">=</span><span class="st">"https://mycompany.sharepoint.com/sites/my-site-url"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">mysite</span><span class="op">$</span><span class="fu">get_drive</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">list_items</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">myteam</span> <span class="op">&lt;-</span> <span class="fu">get_team</span><span class="op">(</span><span class="st">"My team"</span>, tenant<span class="op">=</span><span class="st">"mycompany"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">myteam</span><span class="op">$</span><span class="fu">list_channels</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="va">myteam</span><span class="op">$</span><span class="fu">get_drive</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">list_items</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># retrieving chats</span></span>
<span class="r-in"><span class="fu">get_chat</span><span class="op">(</span><span class="st">"chat-id"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">list_chats</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># you can also use your own app registration ID:</span></span>
<span class="r-in"><span class="fu">get_business_onedrive</span><span class="op">(</span>app<span class="op">=</span><span class="st">"app_id"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">get_sharepoint_site</span><span class="op">(</span><span class="st">"My site"</span>, app<span class="op">=</span><span class="st">"app_id"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># using the app ID for the CLI for Microsoft 365: set a global option</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>microsoft365r_use_cli_app_id<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">get_business_onedrive</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">get_sharepoint_site</span><span class="op">(</span><span class="st">"My site"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">get_team</span><span class="op">(</span><span class="st">"My team"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># authenticating separately to working with the MS365 API</span></span>
<span class="r-in"><span class="va">scopes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span class="r-in">    <span class="st">"https://graph.microsoft.com/Files.ReadWrite.All"</span>,</span>
<span class="r-in">    <span class="st">"https://graph.microsoft.com/User.Read"</span>,</span>
<span class="r-in">    <span class="st">"openid"</span>, <span class="st">"offline_access"</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">app</span> <span class="op">&lt;-</span> <span class="st">"d44a05d5-c6a5-4bbb-82d2-443123722380"</span> <span class="co"># for local use only</span></span>
<span class="r-in"><span class="va">token</span> <span class="op">&lt;-</span> <span class="fu">AzureAuth</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AzureAuth/man/get_azure_token.html" class="external-link">get_azure_token</a></span><span class="op">(</span><span class="va">scopes</span>, <span class="st">"mycompany"</span>, <span class="va">app</span>, version<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">get_business_onedrive</span><span class="op">(</span>token<span class="op">=</span><span class="va">token</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Hong Ooi.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

