<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Outlook mail message — ms_outlook_email • Microsoft365R</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Outlook mail message — ms_outlook_email"><meta property="og:description" content="Class representing an Outlook mail message. The one class represents both sent and unsent (draft) emails."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Microsoft365R</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/auth.html">Authenticating to Microsoft 365</a>
    </li>
    <li>
      <a href="../articles/od_sp.html">OneDrive and SharePoint</a>
    </li>
    <li>
      <a href="../articles/outlook.html">Managing emails with Outlook</a>
    </li>
    <li>
      <a href="../articles/scripted.html">Using Microsoft365R in an unattended script</a>
    </li>
    <li>
      <a href="../articles/shiny.html">Using Microsoft365R in a Shiny app</a>
    </li>
    <li>
      <a href="../articles/teams.html">Teams</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Azure/Microsoft365R/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Outlook mail message</h1>
    <small class="dont-index">Source: <a href="https://github.com/Azure/Microsoft365R/blob/HEAD/R/ms_outlook_email.R" class="external-link"><code>R/ms_outlook_email.R</code></a></small>
    <div class="hidden name"><code>ms_outlook_email.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Class representing an Outlook mail message. The one class represents both sent and unsent (draft) emails.</p>
    </div>


    <div id="format">
    <h2>Format</h2>
    <p>An R6 object of class <code>ms_outlook_email</code>, inheriting from <code>ms_outlook_object</code>, which in turn inherits from <code>ms_object</code>.</p>
    </div>
    <div id="fields">
    <h2>Fields</h2>
    

<ul><li><p><code>token</code>: The token used to authenticate with the Graph host.</p></li>
<li><p><code>tenant</code>: The Azure Active Directory tenant for the email account.</p></li>
<li><p><code>type</code>: always "email" for an Outlook mail message.</p></li>
<li><p><code>properties</code>: The item properties (metadata).</p></li>
</ul></div>
    <div id="methods">
    <h2>Methods</h2>
    

<ul><li><p><code>new(...)</code>: Initialize a new object. Do not call this directly; see 'Initialization' below.</p></li>
<li><p><code>delete(confirm=TRUE)</code>: Delete this email. By default, ask for confirmation first.</p></li>
<li><p><code>update(...)</code>: Update the email's properties (metadata) in Microsoft Graph.</p></li>
<li><p><code>do_operation(...)</code>: Carry out an arbitrary operation on the email.</p></li>
<li><p><code>sync_fields()</code>: Synchronise the R object with the email metadata in Microsoft Graph.</p></li>
<li><p><code>set_body(body=NULL, content_type=NULL)</code>: Update the email body. See 'Editing an email' below.</p></li>
<li><p><code>set_subject(subject)</code>: Update the email subject line.</p></li>
<li><p><code>set_recipients(to=NULL, cc=NULL, bcc=NULL)</code>: Set the recipients for the email, overwriting any existing recipients.</p></li>
<li><p><code>add_recipients(to=NULL, cc=NULL, bcc=NULL)</code>: Adds recipients for the email, leaving existing ones unchanged.</p></li>
<li><p><code>set_reply_to(reply_to=NULL)</code>: Sets the reply-to field for the email.</p></li>
<li><p><code>add_attachment(object, ...)</code>: Adds an attachment to the email. See 'Attachments' below.</p></li>
<li><p><code>add_image(object)</code>: Adds an inline image to the email.</p></li>
<li><p><code>get_attachment(attachment_name=NULL, attachment_id=NULL)</code>: Gets an attachment, either by name or ID. Note that attachments don't need to have unique names; if multiple attachments share the same name, the method throws an error.</p></li>
<li><p><code>list_attachments(filter=NULL, n=Inf)</code>: Lists the current attachments for the email.</p></li>
<li><p><code>remove_attachment(attachment_name=NULL, attachment_id=NULL, confirm=TRUE)</code>: Removes an attachment from the email. By default, ask for confirmation first.</p></li>
<li><p><code>download_attachment(attachment_name=NULL, attachment_id=NULL, ...)</code>: Downloads an attachment. This is only supported for file attachments (not URLs).</p></li>
<li><p><code>send()</code>: Sends an email.  See 'Sending, replying and forwarding'.</p></li>
<li><p><code>create_reply(comment="", send_now=FALSE)</code>: Replies to the sender of an email.</p></li>
<li><p><code>create_reply_all(comment="", send_now=FALSE)</code>: Replies to the sender and all recipients of an email.</p></li>
<li><p><code>create_forward(comment="", to=NULL, cc=NULL, bcc=NULL, send_now=FALSE)</code>: Forwards the email to other recipients.</p></li>
<li><p><code>copy(dest),move(dest)</code>: Copies or moves the email to the destination folder.</p></li>
<li><p><code>get_message_headers</code>: Retrieves the Internet message headers for an email, as a named character vector.</p></li>
</ul></div>
    <div id="initialization">
    <h2>Initialization</h2>
    

<p>Creating new objects of this class should be done via the the appropriate methods for the <code><a href="ms_outlook.html">ms_outlook</a></code> or <code><a href="ms_outlook_folder.html">ms_outlook_folder</a></code> classes. Calling the <code>new()</code> method for this class only constructs the R object; it does not call the Microsoft Graph API to retrieve or create the actual folder.</p>
    </div>
    <div id="editing-an-email">
    <h2>Editing an email</h2>
    

<p>This class exposes several methods for updating the properties of an email. They should work both for unsent (draft) emails and sent ones, although they make most sense in the context of editing drafts.</p>
<p><code>set_body(body, content_type)</code> updates the message body of the email. This has 2 arguments: <code>body</code> which is the body text itself, and <code>content_type</code> which should be either "text" or "html". For both arguments, you can set the value to NULL to leave the current property unchanged. The <code>body</code> argument can also be a message object from either the blastula or emayili packages, much like when creating a new email.</p>
<p><code>set_subject(subject)</code> sets the subject line of the email.</p>
<p><code>set_recipients(to, cc, bcc)</code> sets or clears the recipients of the email. The <code>to</code>, <code>cc</code> and <code>bcc</code> arguments should be lists of either email addresses as character strings, or objects of class <code>az_user</code> representing a user account in Azure Active Directory. The default behaviour is to overwrite any existing recipients; to avoid this, pass <code>NA</code> as the value for the relevant argument. Alternatively, you can use the <code>add_recipients()</code> method.</p>
<p><code>add_recipients(to, cc, bcc)</code> is like <code>set_recipients()</code> but leaves existing recipients unchanged.</p>
<p><code>set_reply_to(reply_to)</code> sets or clears the reply-to address for the email. Leave the <code>reply_to</code> argument at its default NULL value to clear this property.</p>
    </div>
    <div id="attachments">
    <h2>Attachments</h2>
    

<p>This class exposes the following methods for working with attachments.</p>
<p><code>add_attachment(object, type, expiry, password, scope)</code> adds an attachment to the email. The arguments are as follows:</p><ul><li><p><code>object</code>: A character string containing a filename or URL, or an object of class <code><a href="ms_drive_item.html">ms_drive_item</a></code> representing a file in OneDrive or SharePoint. In the latter case, a shareable link to the drive item will be attached to the email, with the link details given by the other arguments.</p></li>
<li><p><code>type, expiry, password, scope</code>: The specifics for the shareable link to attach to the email, if <code>object</code> is a drive item. See the <code>create_share_link()</code> method of the <code><a href="ms_drive_item.html">ms_drive_item</a></code> class; the default is to create a read-only link valid for 7 days.</p></li>
</ul><p><code>add_image(object)</code> adds an image as an <em>inline</em> attachment, ie, as part of the message body. The <code>object</code> argument should be a filename, and the message content type will be set to "html" if it is not already. Currently Microsoft365R does minimal formatting of the image; consider using a package like blastula for more control over the layout of inline images.</p>
<p><code>list_attachments()</code> lists the attachments for the email, including inline images. This will be a list of objects of class <code><a href="ms_outlook_attachment.html">ms_outlook_attachment</a></code> containing the metadata for the attachments.</p>
<p><code>get_attachment(attachment_name, attachment_id)</code>: Retrieves the metadata for an attachment, as an object of class <code>ms_outlook_attachment</code>. Note that multiple attachments can share the same name; in this case, you must specify the ID of the attachment.</p>
<p><code>download_attachment(attachment_name, attachment_id, dest, overwrite)</code>: Downloads a file attachment. The default destination filename is the name of the attachment.</p>
<p><code>remove_attachment(attachment_name, attachment_id)</code> removes (deletes) an attachment.</p>
    </div>
    <div id="sending-replying-and-forwarding">
    <h2>Sending, replying and forwarding</h2>
    

<p>Microsoft365R's default behaviour when creating, replying or forwarding emails is to create a draft message object, to allow for further edits. The draft is saved in the Drafts folder by default, and can be sent later by calling its <code>send()</code> method.</p>
<p>The methods for replying and forwarding are <code>create_reply()</code>, <code>create_reply_all()</code> and <code>create_forward()</code>. The first argument to these is the reply text, which will appear above the current message text in the body of the reply. For <code>create_forward()</code>, the other arguments are <code>to</code>, <code>cc</code> and <code>bcc</code> to specify the recipients of the forwarded email.</p>
    </div>
    <div id="other-methods">
    <h2>Other methods</h2>
    

<p>The <code>copy()</code> and <code>move()</code> methods copy and move an email to a different folder. The destination should be an object of class <code>ms_outlook_folder</code>.</p>
<p>The <code>get_message_headers()</code> method retrieves the Internet message headers for the email, as a named character vector.</p>
    </div>
    <div id="list-methods">
    <h2>List methods</h2>
    

<p>All <code>list_*</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://docs.microsoft.com/en-us/graph/query-parameters#filter-parameter" class="external-link">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="ms_outlook.html">ms_outlook</a></code>, <code><a href="ms_outlook_folder.html">ms_outlook_folder</a></code>, <code><a href="ms_outlook_attachment.html">ms_outlook_attachment</a></code></p>
<p><a href="https://docs.microsoft.com/en-us/graph/overview" class="external-link">Microsoft Graph overview</a>,
<a href="https://docs.microsoft.com/en-us/graph/api/resources/mail-api-overview?view=graph-rest-1.0" class="external-link">Outlook API reference</a></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">outl</span> <span class="op">&lt;-</span> <span class="fu"><a href="client.html">get_personal_outlook</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">##</span></span>
<span class="r-in"><span class="co">## creating a new email</span></span>
<span class="r-in"><span class="co">##</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># a blank text email</span></span>
<span class="r-in"><span class="va">em</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span><span class="fu">create_email</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># add a body</span></span>
<span class="r-in"><span class="va">em</span><span class="op">$</span><span class="fu">set_body</span><span class="op">(</span><span class="st">"Hello from R"</span>, content_type<span class="op">=</span><span class="st">"html"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># add recipients</span></span>
<span class="r-in"><span class="va">em</span><span class="op">$</span><span class="fu">set_recipients</span><span class="op">(</span>to<span class="op">=</span><span class="st">"user@example.com"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># add subject line</span></span>
<span class="r-in"><span class="va">em</span><span class="op">$</span><span class="fu">set_subject</span><span class="op">(</span><span class="st">"example email"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># add an attachment</span></span>
<span class="r-in"><span class="va">em</span><span class="op">$</span><span class="fu">add_attachment</span><span class="op">(</span><span class="st">"mydocument.docx"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># add a shareable link to a file in OneDrive</span></span>
<span class="r-in"><span class="va">mysheet</span> <span class="op">&lt;-</span> <span class="fu"><a href="client.html">get_personal_onedrive</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">get_item</span><span class="op">(</span><span class="st">"documents/mysheet.xlsx"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">em</span><span class="op">$</span><span class="fu">add_attachment</span><span class="op">(</span><span class="va">mysheet</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># add an inline image</span></span>
<span class="r-in"><span class="va">em</span><span class="op">$</span><span class="fu">add_image</span><span class="op">(</span><span class="st">"myggplot.jpg"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># oops, wrong recipient, it should be someone else</span></span>
<span class="r-in"><span class="co"># this removes user@example.com from the to: field</span></span>
<span class="r-in"><span class="va">em</span><span class="op">$</span><span class="fu">set_recipients</span><span class="op">(</span>to<span class="op">=</span><span class="st">"user2@example.com"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># and we should also cc a third user</span></span>
<span class="r-in"><span class="va">em</span><span class="op">$</span><span class="fu">add_recipients</span><span class="op">(</span>cc<span class="op">=</span><span class="st">"user3@example.com"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># send it</span></span>
<span class="r-in"><span class="va">em</span><span class="op">$</span><span class="fu">send</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># you can also compose an email as a pipeline</span></span>
<span class="r-in"><span class="va">outl</span><span class="op">$</span><span class="fu">create_email</span><span class="op">(</span><span class="op">)</span><span class="op">$</span></span>
<span class="r-in">    <span class="fu">set_body</span><span class="op">(</span><span class="st">"Hello from R"</span><span class="op">)</span><span class="op">$</span></span>
<span class="r-in">    <span class="fu">set_recipients</span><span class="op">(</span>to<span class="op">=</span><span class="st">"user2@example.com"</span>, cc<span class="op">=</span><span class="st">"user3@example.com"</span><span class="op">)</span><span class="op">$</span></span>
<span class="r-in">    <span class="fu">set_subject</span><span class="op">(</span><span class="st">"example email"</span><span class="op">)</span><span class="op">$</span></span>
<span class="r-in">    <span class="fu">add_attachment</span><span class="op">(</span><span class="st">"mydocument.docx"</span><span class="op">)</span><span class="op">$</span></span>
<span class="r-in">    <span class="fu">send</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># using blastula to create a HTML email with Markdown</span></span>
<span class="r-in"><span class="va">bl_msg</span> <span class="op">&lt;-</span> <span class="fu">blastula</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/blastula/man/compose_email.html" class="external-link">compose_email</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/blastula/man/md.html" class="external-link">md</a></span><span class="op">(</span></span>
<span class="r-in"><span class="st">"</span>
<span class="r-in">## Hello!</span>
<span class="r-in"></span>
<span class="r-in">This is an email message that was generated by the blastula package.</span>
<span class="r-in"></span>
<span class="r-in">We can use **Markdown** formatting with the `md()` function.</span>
<span class="r-in"></span>
<span class="r-in">Cheers,</span>
<span class="r-in"></span>
<span class="r-in">The blastula team</span>
<span class="r-in">"</span><span class="op">)</span>,</span>
<span class="r-in">    footer<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/blastula/man/md.html" class="external-link">md</a></span><span class="op">(</span><span class="st">"Sent via Microsoft365R"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">outl</span><span class="op">$</span><span class="fu">create_email</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in">    <span class="fu">set_body</span><span class="op">(</span><span class="va">bl_msg</span><span class="op">)</span><span class="op">$</span></span>
<span class="r-in">    <span class="fu">set_subject</span><span class="op">(</span><span class="st">"example blastula email"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">##</span></span>
<span class="r-in"><span class="co">## replying and forwarding</span></span>
<span class="r-in"><span class="co">##</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># get the most recent email in the Inbox</span></span>
<span class="r-in"><span class="va">em</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span><span class="fu">list_emails</span><span class="op">(</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># reply to the message sender, cc'ing Carol</span></span>
<span class="r-in"><span class="va">em</span><span class="op">$</span><span class="fu">create_reply</span><span class="op">(</span><span class="st">"I agree"</span><span class="op">)</span><span class="op">$</span></span>
<span class="r-in">    <span class="fu">add_recipients</span><span class="op">(</span>cc<span class="op">=</span><span class="st">"carol@example.com"</span><span class="op">)</span><span class="op">$</span></span>
<span class="r-in">    <span class="fu">send</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># reply to everyone, setting the reply-to address</span></span>
<span class="r-in"><span class="va">em</span><span class="op">$</span><span class="fu">create_reply_all</span><span class="op">(</span><span class="st">"Please do not reply"</span><span class="op">)</span><span class="op">$</span></span>
<span class="r-in">    <span class="fu">set_reply_to</span><span class="op">(</span><span class="st">"do_not_reply@example.com"</span><span class="op">)</span><span class="op">$</span></span>
<span class="r-in">    <span class="fu">send</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># forward to Dave</span></span>
<span class="r-in"><span class="va">em</span><span class="op">$</span><span class="fu">create_forward</span><span class="op">(</span><span class="st">"FYI"</span>, to<span class="op">=</span><span class="st">"dave@example.com"</span><span class="op">)</span><span class="op">$</span></span>
<span class="r-in">    <span class="fu">send</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">##</span></span>
<span class="r-in"><span class="co">## attachments</span></span>
<span class="r-in"><span class="co">##</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># download an attachment by name (assumes there is only one 'myfile.docx')</span></span>
<span class="r-in"><span class="va">em</span><span class="op">$</span><span class="fu">download_attachment</span><span class="op">(</span><span class="st">"myfile.docx"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># a more reliable way: get the list of attachments, and download via the object</span></span>
<span class="r-in"><span class="va">atts</span> <span class="op">&lt;-</span> <span class="va">em</span><span class="op">$</span><span class="fu">list_attachments</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="va">atts</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="fu">download</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># add and remove an attachment</span></span>
<span class="r-in"><span class="va">em</span><span class="op">$</span><span class="fu">add_attachment</span><span class="op">(</span><span class="st">"anotherfile.pptx"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">em</span><span class="op">$</span><span class="fu">remove_attachment</span><span class="op">(</span><span class="st">"anotherfile.pptx"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">##</span></span>
<span class="r-in"><span class="co">## moving and copying</span></span>
<span class="r-in"><span class="co">##</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># copy an email to a nested folder: /folder1/folder2</span></span>
<span class="r-in"><span class="va">dest</span> <span class="op">&lt;-</span> <span class="va">outl</span><span class="op">$</span><span class="fu">get_folder</span><span class="op">(</span><span class="st">"folder1"</span><span class="op">)</span><span class="op">$</span><span class="fu">get_folder</span><span class="op">(</span><span class="st">"folder2"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">em</span><span class="op">$</span><span class="fu">copy</span><span class="op">(</span><span class="va">dest</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># move it instead</span></span>
<span class="r-in"><span class="va">em</span><span class="op">$</span><span class="fu">move</span><span class="op">(</span><span class="va">dest</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Hong Ooi.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

