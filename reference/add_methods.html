<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Microsoft 365 object accessor methods — add_methods • Microsoft365R</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Microsoft 365 object accessor methods — add_methods"><meta property="og:description" content="Methods for the AzureGraph::ms_graph, AzureGraph::az_user and AzureGraph::az_group classes."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Microsoft365R</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.3.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/auth.html">Authenticating to Microsoft 365</a>
    </li>
    <li>
      <a href="../articles/od_sp.html">OneDrive and SharePoint</a>
    </li>
    <li>
      <a href="../articles/outlook.html">Managing emails with Outlook</a>
    </li>
    <li>
      <a href="../articles/scripted.html">Using Microsoft365R in an unattended script</a>
    </li>
    <li>
      <a href="../articles/shiny.html">Using Microsoft365R in a Shiny app</a>
    </li>
    <li>
      <a href="../articles/teams.html">Teams</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Azure/Microsoft365R/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Microsoft 365 object accessor methods</h1>
    <small class="dont-index">Source: <a href="https://github.com/Azure/Microsoft365R/blob/HEAD/R/add_methods.R" class="external-link"><code>R/add_methods.R</code></a></small>
    <div class="hidden name"><code>add_methods.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Methods for the <code><a href="https://rdrr.io/pkg/AzureGraph/man/ms_graph.html" class="external-link">AzureGraph::ms_graph</a></code>, <code><a href="https://rdrr.io/pkg/AzureGraph/man/az_user.html" class="external-link">AzureGraph::az_user</a></code> and <code><a href="https://rdrr.io/pkg/AzureGraph/man/az_group.html" class="external-link">AzureGraph::az_group</a></code> classes.</p>
    </div>


    <div id="usage">
    <h2>Usage</h2>
    
<div class="sourceCode"><pre><code><span class="co">## R6 method for class 'az_user'</span>
<span class="fu"><a href="../reference/client.html">get_chat</a></span><span class="op">(</span><span class="va">chat_id</span><span class="op">)</span>

<span class="co">## R6 method for class 'ms_graph'</span>
<span class="fu">get_drive</span><span class="op">(</span><span class="va">drive_id</span><span class="op">)</span>

<span class="co">## R6 method for class 'az_user'</span>
<span class="fu">get_drive</span><span class="op">(</span>drive_id <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>

<span class="co">## R6 method for class 'az_group'</span>
<span class="fu">get_drive</span><span class="op">(</span>drive_name <span class="op">=</span> <span class="cn">NULL</span>, drive_id <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>

<span class="co">## R6 method for class 'az_group'</span>
<span class="fu">get_plan</span><span class="op">(</span>plan_title <span class="op">=</span> <span class="cn">NULL</span>, plan_id <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>

<span class="co">## R6 method for class 'ms_graph'</span>
<span class="fu"><a href="../reference/client.html">get_sharepoint_site</a></span><span class="op">(</span>site_url <span class="op">=</span> <span class="cn">NULL</span>, site_id <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>

<span class="co">## R6 method for class 'az_group'</span>
<span class="fu"><a href="../reference/client.html">get_sharepoint_site</a></span><span class="op">(</span><span class="op">)</span>

<span class="co">## R6 method for class 'ms_graph'</span>
<span class="fu"><a href="../reference/client.html">get_team</a></span><span class="op">(</span>team_id <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>

<span class="co">## R6 method for class 'az_group'</span>
<span class="fu"><a href="../reference/client.html">get_team</a></span><span class="op">(</span><span class="op">)</span>

<span class="co">## R6 method for class 'az_user'</span>
<span class="fu"><a href="../reference/client.html">list_chats</a></span><span class="op">(</span>filter <span class="op">=</span> <span class="cn">NULL</span>, n <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>

<span class="co">## R6 method for class 'az_user'</span>
<span class="fu">list_drives</span><span class="op">(</span>filter <span class="op">=</span> <span class="cn">NULL</span>, n <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>

<span class="co">## R6 method for class 'az_group'</span>
<span class="fu">list_drives</span><span class="op">(</span>filter <span class="op">=</span> <span class="cn">NULL</span>, n <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>

<span class="co">## R6 method for class 'az_group'</span>
<span class="fu">list_plans</span><span class="op">(</span>filter <span class="op">=</span> <span class="cn">NULL</span>, n <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>

<span class="co">## R6 method for class 'az_user'</span>
<span class="fu"><a href="../reference/client.html">list_sharepoint_sites</a></span><span class="op">(</span>filter <span class="op">=</span> <span class="cn">NULL</span>, n <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>

<span class="co">## R6 method for class 'az_user'</span>
<span class="fu"><a href="../reference/client.html">list_teams</a></span><span class="op">(</span>filter <span class="op">=</span> <span class="cn">NULL</span>, n <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></code></pre></div>

    </div>
    <div id="arguments">
    <h2>Arguments</h2>
    

<ul><li><p><code>drive_name</code>,<code>drive_id</code>: For <code>get_drive</code>, the name or ID of the drive or shared document library. Note that only the <code>az_group</code> method  has the <code>drive_name</code> argument, as user drives do not have individual names (and most users will only have one drive anyway). For the <code>az_user</code> and <code>az_group</code> methods, leaving the argument(s) blank will return the default drive/document library.</p></li>
<li><p><code>site_url</code>,<code>site_id</code>: For <code>ms_graph$get_sharepoint_site()</code>, the URL and ID of the site. Provide one or the other, but not both.</p></li>
<li><p><code>team_name</code>,<code>team_id</code>: For <code>az_user$get_team()</code>, the name and ID of the site. Provide one or the other, but not both. For <code>ms_graph$get_team</code>, you must provide the team ID.</p></li>
<li><p><code>plan_title</code>,<code>plan_id</code>: For <code>az_group$get_plan()</code>, the title and ID of the site. Provide one or the other, but not both.</p></li>
<li><p><code>filter, n</code>: See 'List methods' below.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    

<p><code>get_sharepoint_site</code> retrieves a SharePoint site object. The method for the top-level Graph client class requires that you provide either the site URL or ID. The method for the <code>az_group</code> class will retrieve the site associated with that group, if applicable.</p>
<p><code>get_drive</code> retrieves a OneDrive or shared document library, and <code>list_drives</code> retrieves all such drives/libraries that the user or group has access to. Whether these are personal or business drives depends on the tenant that was specified in <code><a href="https://rdrr.io/pkg/AzureGraph/man/graph_login.html" class="external-link">AzureGraph::get_graph_login()</a></code>/<code>create_graph_login()</code>: if this was "consumers" or "9188040d-6c67-4c5b-b112-36a304b66dad" (the equivalent GUID), it will be the personal OneDrive. See the examples below.</p>
<p><code>get_plan</code> retrieves a plan (not to be confused with a Todo task list), and <code>list_plans</code> retrieves all plans for a group.</p>
<p><code>get_team</code> retrieves a team. The method for the Graph client class requires the team ID. The method for the <code>az_user</code> class requires either the team name or ID. The method for the <code>az_group</code> class retrieves the team associated with the group, if it exists.</p>
<p><code>get_chat</code> retrieves a one-on-one, group or meeting chat, by ID. <code>list_chats</code> retrieves all chats that the user is part of.</p>
<p>Note that Teams, SharePoint and OneDrive for Business require a Microsoft 365 Business license, and are available for organisational tenants only. Similarly, only Microsoft 365 groups can have associated sites/teams/plans/drives, not any other kind of group.</p>
    </div>
    <div id="list-methods">
    <h2>List methods</h2>
    

<p>All <code>list_*</code> methods have <code>filter</code> and <code>n</code> arguments to limit the number of results. The former should be an <a href="https://docs.microsoft.com/en-us/graph/query-parameters#filter-parameter" class="external-link">OData expression</a> as a string to filter the result set on. The latter should be a number setting the maximum number of (filtered) results to return. The default values are <code>filter=NULL</code> and <code>n=Inf</code>. If <code>n=NULL</code>, the <code>ms_graph_pager</code> iterator object is returned instead to allow manual iteration over the results.</p>
<p>Support in the underlying Graph API for OData queries is patchy. Not all endpoints that return lists of objects support filtering, and if they do, they may not allow all of the defined operators. If your filtering expression results in an error, you can carry out the operation without filtering and then filter the results on the client side.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>For <code>get_sharepoint_site</code>, an object of class <code>ms_site</code>.</p>
<p>For <code>get_drive</code>, an object of class <code>ms_drive</code>. For <code>list_drives</code>, a list of <code>ms_drive</code> objects.</p>
<p>For <code>get_plan</code>, an object of class <code>ms_plan</code>. For <code>list_plans</code>, a list of <code>ms_plan</code> objects.</p>
<p>For <code>get_team</code>, an object of class <code>ms_team</code>. For <code>list_teams</code>, a list of <code>ms_team</code> objects.</p>
<p>For <code>get_chat</code>, an object of class <code>ms_chat</code>. For <code>list_chats</code>, a list of <code>ms_chat</code> objects.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="ms_site.html">ms_site</a></code>, <code><a href="ms_drive.html">ms_drive</a></code>, <code><a href="ms_plan.html">ms_plan</a></code>, <code><a href="ms_team.html">ms_team</a></code>, <code><a href="ms_chat.html">ms_chat</a></code>, <code>az_user</code>, <code>az_group</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># 'consumers' tenant -&gt; personal OneDrive for a user</span></span>
<span class="r-in"><span class="va">gr</span> <span class="op">&lt;-</span> <span class="fu">AzureGraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AzureGraph/man/graph_login.html" class="external-link">get_graph_login</a></span><span class="op">(</span><span class="st">"consumers"</span>, app<span class="op">=</span><span class="st">"myapp"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">me</span> <span class="op">&lt;-</span> <span class="va">gr</span><span class="op">$</span><span class="fu">get_user</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="va">me</span><span class="op">$</span><span class="fu">get_drive</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># organisational tenant -&gt; business OneDrive for a user</span></span>
<span class="r-in"><span class="va">gr2</span> <span class="op">&lt;-</span> <span class="fu">AzureGraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AzureGraph/man/graph_login.html" class="external-link">get_graph_login</a></span><span class="op">(</span><span class="st">"mycompany"</span>, app<span class="op">=</span><span class="st">"myapp"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">myuser</span> <span class="op">&lt;-</span> <span class="va">gr2</span><span class="op">$</span><span class="fu">get_user</span><span class="op">(</span><span class="st">"username@mycompany.onmicrosoft.com"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">myuser</span><span class="op">$</span><span class="fu">get_drive</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># get a site/drive directly from a URL/ID</span></span>
<span class="r-in"><span class="va">gr2</span><span class="op">$</span><span class="fu">get_sharepoint_site</span><span class="op">(</span><span class="st">"My site"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">gr2</span><span class="op">$</span><span class="fu">get_drive</span><span class="op">(</span><span class="st">"drive-id"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># site/drive(s) for a group</span></span>
<span class="r-in"><span class="va">grp</span> <span class="op">&lt;-</span> <span class="va">gr2</span><span class="op">$</span><span class="fu">get_group</span><span class="op">(</span><span class="st">"group-id"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">grp</span><span class="op">$</span><span class="fu">get_sharepoint_site</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="va">grp</span><span class="op">$</span><span class="fu">list_drives</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="va">grp</span><span class="op">$</span><span class="fu">get_drive</span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Hong Ooi.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

